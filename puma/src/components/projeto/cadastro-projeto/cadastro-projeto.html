<div class="main-content">
  <b-container fluid>
    <b-row>
      <b-col cols="12">
        <div class='main-title'>
          <!-- Sempre será apenas CADASTRAR -->
          {{ operacao === 'visualizar' ? 'Visualizar Projeto': (operacao === 'alterar' ? 'Alterar Projeto' : 'Cadastrar
          Projeto') }}
        </div>
      </b-col>
    </b-row>
    <div class="py-1" />
    <ValidationObserver ref="observer" v-slot="{invalid}" @submit.prevent="onSubmit()">
      <b-row class="form m-0 p-4">
        <b-col cols="6">
          <ValidationProvider rules="required|min:200" v-slot="v" :bails="false" name="desafio enfrentado">
            <div role="group">
              <label for="descricao" class="title-textarea">Desafio Enfrentado</label>
              <div class="error-div">
                <textarea id="descricao" placeholder="Descreva o desafio enfrentado usando, no mínimo, 200 caracteres."
                  maxlength="1000" rows="7" v-model="descricao.val" :disabled=isLoading class="textarea-field"
                  v-bind:class="{ inputFieldRegisterProject: !v.errors.length && operacao !== 'visualizar' }"
                  v-bind:style="v.errors.length ? { borderColor: '#EB0600' } : {}">
                  </textarea>
                <span class="error-span" v-for="erro in v.errors">
                  {{ erro }}
                </span>
              </div>
            </div>
          </ValidationProvider>
          <div class="py-3" />
          <ValidationProvider rules="required" v-slot="v" :bails="false" name="resultado desejado">
            <div role="group">
              <label for="resultado" class="title-textarea">Resultado Desejado</label>
              <div class="error-div">
                <textarea id="resultado" placeholder="Descreva os resultados desejados" rows="5" minlength="40"
                  maxlength="500" v-model="resultadoEsperado.val" class="textarea-field"
                  v-bind:class="{ inputFieldRegisterProject: !v.errors.length && operacao !== 'visualizar' }"
                  v-bind:style="v.errors.length ? { borderColor: '#EB0600' } : {}" :disabled=isLoading></textarea>
                <span class="error-span" v-for="erro in v.errors">
                  {{ erro }}
                </span>
              </div>
            </div>
          </ValidationProvider>
          <div class="py-3" />
          <ValidationProvider rules="required" v-slot="v" :bails="false" name="título">
            <div role="group">
              <label for="titulo" class="title-textarea">Título para o projeto</label>
              <div class="error-div">
                <input type="text" id="titulo" maxlength="100" class="title-input-field"
                  placeholder="Crie um título que indique o objetivo do projeto" v-model="titulo.val"
                  v-bind:class="{ inputFieldRegisterProject: !v.errors.length && operacao !== 'visualizar' }"
                  v-bind:style="v.errors.length ? { borderColor: '#EB0600' } : {}" :disabled=isLoading>
                <span class="error-span" v-for="erro in v.errors">
                  {{ erro }}
                </span>
              </div>
              <div v-if="operacao !== 'visualizar'" class="text-description">Opte por títulos que comecem com substantivos. Exemplo: </div>
              <div v-if="operacao !== 'visualizar'" class="text-example"><i>Eliminação do despedício na produção de pães artesanais</i></div>
            </div>
          </ValidationProvider>
        </b-col>
        <b-col cols="6">
          <div role="group">
            <label class="title-keywords">
              Palavras-chave
            </label>
            <multiselect
              id="keywords"
              v-model="keywordsSelected"
              :options="keywords"
              track-by="keywordid"
              label="keyword"
              :multiple="true"
              openDirection="bottom"
              :placeholder="multiSelectPlaceholder"
              :searchable="true"
              :showLabels="true"
              :closeOnSelect="false"
              :max-height="150"
              :max="3"
              @input="sortMultiselectLabels()"
              selectLabel=""
              deselectLabel=""
              selectedLabel=""
              @open = "multiSelectPlaceholder = 'Pesquisar'"
              @close="isMultiselectTouched = true; multiSelectPlaceholder = 'Selecione'"
              :loading="isLoadingKeywords"
              class="multiselect-custom"
              :disabled="isLoadingKeywords || !keywords.length || operacao === 'visualizar'">
              <template slot="option" slot-scope="scope">
                <div class="option__desc checkbox-label">
                  <input class="mx-2" type="checkbox" :checked="isChecked(scope.option)" @focus.prevent :key="scope.option.keywordid" />
                  <span class="option__title">{{ scope.option.keyword }}</span>
                </div>
              </template>
              <span slot="maxElements">
                Máximo de 3 opções selecionadas. Remova ao menos uma palavra-chave.
              </span>
              <span slot="noResult">
                Nenhuma palavra-chave encontrada.
              </span>
            </multiselect>
            <span v-if="isMultiselectTouched && !keywordsSelected.length" class="error-span">
              Escolha no mínimo uma palavra-chave
            </span>
          </div>
          <div class="py-3" />
          <div class="btn-toolbar">
            <div v-if="operacao !== 'visualizar'">
              <input :value="operacao === 'editar' ? 'Editar' : 'Enviar'" v-if="!isLoading && operacao !== 'visualizar'"
                type="submit" class="btn btn-warning" @click="onSubmit" />
            </div>
            <div class="m-4" />
            <b-button v-if="operacao !== 'visualizar'" href="/meus-projetos" class="btn btn-warning">
              CANCELAR
            </b-button>
          </div>
        </b-col>
      </b-row>
    </ValidationObserver>
  </b-container>
</div>
